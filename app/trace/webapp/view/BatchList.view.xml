<mvc:View
  controllerName="trace.controller.BatchList"
  xmlns:mvc="sap.ui.core.mvc"
  xmlns="sap.m">

  <Page title="Batches" id="batchListPage">
    <headerContent>
      <Button text="Create Batch" icon="sap-icon://add" type="Emphasized" press="onCreateBatch"/>
      <Button icon="sap-icon://refresh" press="onRefresh" tooltip="Refresh"/>
    </headerContent>

    <List id="batchTable"
      items="{
        path: '/Batches',
        parameters: {
          $expand: 'manufacturer,currentHolder',
          $orderby: 'modifiedAt desc'
        }
      }"
      growing="true"
      growingThreshold="50"
      mode="SingleSelectMaster"
      itemPress="onBatchPress">

      <headerToolbar>
        <OverflowToolbar>
          <Title text="All Batches" level="H3"/>
          <ToolbarSpacer/>
          <SearchField width="20rem" liveChange="onSearch" placeholder="Search by batch number or product..."/>
        </OverflowToolbar>
      </headerToolbar>

      <items>
        <ObjectListItem
          type="Navigation"
          title="{batchNumber}"
          number="{status}"
          numberState="{path: 'status', formatter: '.formatStatusState'}"
          intro="{product}"
          icon="{path: 'status', formatter: '.formatStatusIcon'}">
          <attributes>
            <ObjectAttribute title="Manufacturer" text="{manufacturer/name}" />
            <ObjectAttribute title="Current Holder" text="{currentHolder/name}" />
            <ObjectAttribute title="Modified" text="{
              path: 'modifiedAt',
              type: 'sap.ui.model.type.DateTime',
              formatOptions: { style: 'medium' }
            }" />
          </attributes>
        </ObjectListItem>
      </items>
    </List>
  </Page>
</mvc:View>
